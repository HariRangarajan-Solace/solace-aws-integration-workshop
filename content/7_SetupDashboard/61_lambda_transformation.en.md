---
title: "Create Lambda function for data ingestion"
chapter: true
weight: 1 
---

## Introduction
Create Lambda functions and S3 bucket trigger.

1. Go to AWS Lambda console, select menu "Functions", and the click "Create Function"

![Create Lambda function](/static/images/moduleSix/lambdaCreateFunctions.png)

2. Now, specify the parameters required by Lambda function.
* Function name: 'S3ToSearch' (or any name of your own choice)
* Runtime: Choose Python 3.11
* Execution role: Choose 'solace_work_lambda_role', which is generated by the cloudFormation template already


![Specify Lambda parameters](/static/images/moduleSix/lambdaCreation.png)


3. Add Lambda source code, by choosing **Upload from**, then **.zip**file


![Upload Lambda source code](/static/images/moduleSix/LambdaUploadCode.png)

The zip file, which contains Lambda code and the all dependencies, can be found here:
[Github link for lambda zip file](https://github.com/HariRangarajan-Solace/aws-modernization-workshop-base/blob/dashboard/dashboard/s3-to-opensearch/lambda.zip)

4. Replace OpenSearch endpoint host name in **line 57**, also make sure the region code is correct in **line 50**

![Update your Lambda function](/static/images/moduleSix/LambdaEditSourceCode.png)


The endpoint host name can be found from Open Search Dashboard. Since only the **host** name is required, make sure the "https://" is removed from the url.
![OpenSearch endpoint](/static/images/moduleSix/OpenSearchEndPoint.png)

or your CloudFormation Output:
![OpenSearch endpoint](/static/images/moduleSix/CloudFormationOutput.png)

5. Now, set up S3 bucket trigger. This is make sure when each solace data file is added into the S3 bucket, it will be ingested into OpenSearch index right away.
* Select a source: Choose "S3"
* Bucket: Choose "Solace-workshop-xxxxx"
* Event Type: Choose "All object create events"
* Tick "Recursive invocation" warning

![set up the trigger on S3 bucket](/static/images/moduleSix/LamdaTriggerConfig.png)

